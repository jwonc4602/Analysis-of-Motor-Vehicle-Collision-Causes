---
title: "Analysis of Motor Vehicle Collision Causes in Toronto from 2006 to 2023"
subtitle: "Exploring the Interplay of Human Behavior and Environmental Factors in Predicting Accident Severity and High-Risk Scenarios"
author: 
  - Jiwon Choi
thanks: "Code and data are available at: https://github.com/jwonc4602/Analysis-of-Motor-Vehicle-Collision-Causes."
date: today
date-format: long
abstract: "This paper analyzes motor vehicle collisions in Toronto from 2006 to 2023, focusing on the interplay between human behavior and environmental factors. The study examines how behaviors such as speeding, aggressive driving, alcohol consumption, and disability contribute to accidents alongside conditions like visibility, lighting, and road surface. Findings reveal that while environmental factors can exacerbate risks, human actions, particularly aggressive driving and alcohol use, are the most significant contributors to severe collisions. These insights are critical for developing predictive models and preventive strategies that can enhance urban road safety by addressing both driver behavior and infrastructure improvements."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace set-up ####

## Load packages
library(tidyverse)
library(knitr)
library(here)
library(dplyr)
library(ggplot2)
library(readr)
library(gridExtra)
library(grid)

#read in cleaned data #
#total_cleaned_data
cleaned_data <- read.csv(here::here("data/analysis_data/total_cleaned_data.csv"))
show_col_types = FALSE

# human factors data
human_factors_data <- read.csv(here::here("data/analysis_data/human_factors_data.csv"))
show_col_types = FALSE

# environmental factors data
environmental_factors_data <- read.csv(here::here("data/analysis_data/environmental_factors_data.csv"))
show_col_types = FALSE

```


# Introduction

Motor vehicle collisions remain one of the leading causes of injury and fatality in urban environments, prompting ongoing research into how these incidents can be mitigated. In a rapidly growing city like Toronto, understanding the causes of traffic accidents is essential for improving road safety and informing policy. This paper investigates traffic collisions in Toronto over a 17-year span, analyzing the combined effects of human behavior and environmental conditions to determine which factors most significantly contribute to the frequency and severity of accidents.

Despite extensive research on individual factors like speeding or poor road conditions, there remains a gap in understanding how human behaviors interact with environmental conditions to create high-risk scenarios for accidents. Existing studies tend to focus on either human or environmental factors in isolation, missing the crucial interplay between these elements. This research aims to fill that gap by examining both human and environmental factors in tandem, providing a more holistic view of traffic accident causes in an urban context.

Using data from Toronto Police Services, this study explores the role of speeding, aggressive driving, alcohol consumption, and disability alongside environmental factors such as visibility, lighting, traffic control, and road surface conditions. The findings reveal that aggressive driving and alcohol use, especially under favorable road conditions, are leading contributors to collisions. The study also identifies high-risk combinations, such as aggressive driving on dry roads under clear visibility, which result in the highest number of accidents. These results are important because they offer a nuanced understanding of traffic safety and suggest that targeted interventions, such as stricter penalties for reckless driving or improved traffic control in key areas, could significantly reduce accidents.

The remainder of this paper is structured as follows. Section 2 provides a detailed description of the data and methodology. Section 3 presents the analysis of human and environmental factors contributing to traffic collisions. Section 4 discusses the results, highlighting high-risk scenarios and potential interventions. Finally, Section 5 addresses the limitations of the current study and outlines directions for future research, particularly the need to account for the growing presence of autonomous driving technologies in collision analysis.


# Data {#sec-data}

## Data Source

This research is based on a dataset published by Toronto Police Services, which is accessible through the City of Toronto’s OpenDataToronto Library [@rOpenDataToronto]. The specific dataset includes all traffic collisions events in Toronto where a person was either Killed or Seriously Injured (KSI) since 2006.

## Data Collection

The methodology for gathering data is structured to ensure a detailed and current perspective of shelter and overnight service. The data was compiled and examined using the R statistical programming software [@r], supplemented by various tools such as `tidyverse` [@rTidyverse], `ggplot2` [@rGgplot2], `dplyr` [@rDplyr], `readr` [@rReadr], `tibble` [@rTibble], `janitor` [@rJanitor], `knitr` [@rknitr], and `here` [@rHere].

This traffic accident data consists of 18,957 entries from a citywide accident survey, capturing detailed information about various factors involved in traffic incidents. The raw dataset includes 50 variables, ranging from geographic data, such as the street where the accident occurred, to behavioral data, such as driver condition and alcohol involvement. This dataset records accidents over multiple years and provides insights into environmental conditions, road types, and the actions of drivers and pedestrians at the time of the incidents. The goal of this dataset is to provide a comprehensive view of traffic accidents for research and policy analysis related to urban traffic safety and accident prevention.

The cleaned data is divided into two datasets, and the first one focuses on human factors related to traffic collisions, specifically the behaviors and conditions of drivers that may have contributed to accidents. The four main categories—'speeding', 'ag_driv', 'alcohol', and 'disability'—were selected because these are well-known, critical factors that significantly increase the risk of traffic accidents. Each factor is evaluated as either "None" or "Yes", indicating the absence or presence of that factor in the collision. These categories were chosen because they represent preventable human actions or conditions that are highly correlated with the likelihood and severity of traffic incidents. (see @tbl-cleaned-human-factors-data)

1. **speeding**: Refers to collisions where speeding was a contributing factor. Speeding reduces a driver's ability to react quickly to road conditions or obstacles, and it increases the severity of crashes when they occur, making it one of the primary causes of traffic collisions.

2. **ag_driv**: This category examines whether aggressive behavior, such as reckless driving, or distracted driving (like texting or talking on the phone) was involved in the collision. Aggressive and distracted driving are known to impair judgment and reaction time, leading to accidents that could otherwise have been avoided.

3. **alcohol**: Evaluates if alcohol was a factor in the collision. Alcohol impairs motor skills and decision-making, and is a well-documented contributor to severe and fatal traffic accidents. This category is crucial for understanding the role of substance use in driver behavior.

4. **disability**: Assesses if any medical or physical disability played a role in the collision. Disabilities, whether temporary or permanent, can affect a driver's ability to control the vehicle or respond to changing road conditions, making this an important factor to consider in the context of traffic safety.

These categories were selected because they represent key human factors that have a direct impact on traffic safety, and addressing them can help reduce both the frequency and severity of accidents.

```{r}
#| message: false
#| echo: false
#| label: fig-frequency-factors-tall
#| fig-cap: Frequency of human factors with thinner numbers and taller graph

# Convert relevant columns to factors and reorder them for better readability
human_factors_data <- human_factors_data %>%
  mutate(speeding = factor(speeding, levels = c("None", "Yes")),
         ag_driv = factor(ag_driv, levels = c("None", "Yes")),
         alcohol = factor(alcohol, levels = c("None", "Yes")),
         disability = factor(disability, levels = c("None", "Yes")))

# Frequency summary for each factor
factor_summary <- human_factors_data %>%
  summarise(
    speeding = sum(speeding == "Yes"),
    ag_driv = sum(ag_driv == "Yes"),
    alcohol = sum(alcohol == "Yes"),
    disability = sum(disability == "Yes")
  ) %>%
  tidyr::gather(key = "factor", value = "count")

# Split the category name for 'ag_driv'
factor_summary <- factor_summary %>%
  mutate(factor = str_replace_all(factor, "ag_driv", "aggressive\nand disturbed driving"))

# Reorder factors based on count for better visualization
factor_summary <- factor_summary %>%
  mutate(factor = forcats::fct_reorder(factor, count, .desc = TRUE))

# Bar plot with thinner numbers and taller graph
ggplot(factor_summary, aes(x = factor, y = count, fill = factor)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = count), vjust = -0.5, nudge_y = 200, size = 3, fontface = "plain", color = "black") +  # Thinner numbers
  theme_minimal() +
  labs(title = "Frequency of Human Factors in Traffic Collisions",
       x = "Human Factors",
       y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Adjust x-axis labels
  coord_cartesian(ylim = c(0, 11000))  # Adjust the y-axis limit to make the graph taller

```

```{r}
#| message: false
#| echo: false
#| label: fig-trend-over-time
#| fig-cap: Trends of human factors in traffic collisions over time

# Convert the date column to date format
human_factors_data <- human_factors_data %>%
  mutate(date = as.Date(date, format = "%Y-%m-%d"))

# Summarise the presence of each factor by year
trend_data <- human_factors_data %>%
  mutate(year = lubridate::year(date)) %>%
  group_by(year) %>%
  summarise(
    speeding = sum(speeding == "Yes"),
    ag_driv = sum(ag_driv == "Yes"),
    alcohol = sum(alcohol == "Yes"),
    disability = sum(disability == "Yes")
  ) %>%
  tidyr::gather(key = "factor", value = "count", -year)

# Line plot to show trends over time
ggplot(trend_data, aes(x = year, y = count, color = factor)) +
  geom_line(linewidth = 0.8) +
  theme_minimal() +
  labs(title = "Trends in Human Factors Over Time",
       x = "Year",
       y = "Count of Collisions",
       color = "Human Factor")
```


The second dataset focuses on the environmental factors influencing traffic collisions, capturing the conditions that shape driver behavior and contribute to accidents. These factors, including traffic control, visibility, lighting, and road surface conditions, play a vital role in either increasing or reducing the risk of collisions. The following modifications were made to simplify and group these categories, making the data more consistent and easier to analyze. The merged categories provide clearer insights into how these factors affect accidents and highlight areas for safety improvements. (see @tbl-cleaned-environmental-factors-data)

1. **traffic_control_type**: This category was simplified to include "No Control," "Traffic Signal," and "Others." The "Others" category consolidates less frequent types of traffic control, such as "Stop Sign," "Pedestrian Crossover," and "School Guard." This grouping reflects the most significant distinctions in how traffic is regulated, emphasizing scenarios where the presence or absence of formal traffic control could impact driver behavior. By focusing on the broad types of control, this category helps assess how different levels of traffic management influence accident risks.

2. **visibility**: The visibility conditions were grouped into "Clear" and "Disturbed." The "Disturbed" category includes various adverse weather conditions such as "Fog, Mist, Smoke, Dust," "Rain," "Snow," and "Strong Wind." This grouping simplifies the analysis by highlighting the key distinction between ideal and hazardous visibility conditions, which directly affect a driver’s ability to see and react to road conditions. Poor visibility is a known contributor to accidents, making this distinction critical for identifying environmental hazards.

3. **light**: The lighting conditions were merged into three categories: "Dark" (which includes "Dark" and "Dark, artificial"), "Daylight" (including "Daylight" and "Daylight, artificial"), and "Dim Light" (covering "Dawn," "Dusk," and similar intermediate lighting conditions). These groups reflect the significant lighting scenarios that impact driver visibility. Dark and dim lighting can reduce reaction times and perception, making these categories essential for understanding how lighting conditions contribute to accidents.

4. **road_surface_condition**: Road surface conditions were consolidated into "Dry," "Wet," and "Others." The "Others" category includes conditions like "Ice," "Loose Snow," and "Slush," which can severely reduce traction. Grouping less common conditions into "Others" helps streamline the analysis by focusing on the primary road conditions that affect vehicle control. Wet or slippery surfaces are known to increase accident risks, making this distinction important for understanding how road conditions influence collisions.

These categories were selected and modified to prioritize the most critical environmental factors that affect traffic safety. By simplifying and grouping related variables, the data becomes more interpretable, allowing for a clearer focus on how environmental factors like traffic control, visibility, lighting, and road conditions contribute to motor vehicle collisions. This approach not only aids in identifying preventable causes but also supports efforts to improve road safety and reduce collision rates through targeted interventions.

```{r}
#| message: false
#| echo: false
#| label: tbl-cleaned-environmental-factors-data
#| tbl-cap: Sample of Environmental Factors of Collision Data

head (environmental_factors_data, 5) |>
  kable(
    col.names = c("date", "traffctl", "visibility", "light", "rdsfcond"),
  booktabs = TRUE
  )
```

```{r}
#| message: false
#| echo: false
#| label: fig-four-graphs-layout
#| fig-cap: Combined layout with four simplified collision graphs

# Common theme
common_theme <- theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),  # Slightly larger font for clarity
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    plot.title = element_text(size = 10),
    plot.margin = margin(t = 15, r = 15, b = 15, l = 15)  # Margins for more space
  )

# First plot: Traffic Control Type and Visibility Conditions

# Plot 1: Traffic Control Type
plot1 <- ggplot(environmental_factors_data, aes(x = traffctl)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +
  labs(title = "Collisions by Traffic Control Type",
       x = "Traffic Control Type",
       y = "Number of Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$traffctl)) * 1.2))

# Plot 2: Visibility Conditions
plot2 <- ggplot(environmental_factors_data, aes(x = visibility)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +
  labs(title = "Collisions by Visibility Conditions",
       x = "Visibility",
       y = "Number of Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$visibility)) * 1.2))

# Arrange these two plots side by side
first_plot_pair <- grid.arrange(plot1, plot2, ncol = 2, 
                                top = textGrob("Environmental Factors Affecting Collisions", gp = gpar(fontsize = 15, fontface = "bold")))

```

```{r}
#| message: false
#| echo: false
#| label: tbl-cleaned-environmental-factors-data-2
#| tbl-cap: Sample of Environmental Factors of Collision Data 2

# Common theme
common_theme <- theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_text(size = 10),
    plot.title = element_text(size = 10),  # No bold here
    plot.margin = margin(t = 15, r = 15, b = 15, l = 15)  # Margins for more space
  )

# Second plot: Lighting Conditions and Road Surface Condition

# Plot 3: Lighting Conditions
plot3 <- ggplot(environmental_factors_data, aes(x = light)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +  # Apply the common theme
  labs(title = "Collisions by Lighting Conditions",
       x = "Lighting Conditions",
       y = "Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$light)) * 1.2))

# Plot 4: Road Surface Conditions
plot4 <- ggplot(environmental_factors_data, aes(x = rdsfcond)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +  # Apply the common theme
  labs(title = "Collisions by Road Surface Condition",
       x = "Road Surface Condition",
       y = "Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$rdsfcond)) * 1.2))

# Arrange these two plots side by side
second_plot_pair <- grid.arrange(plot3, plot4, ncol = 2, 
                                 top = textGrob("Environmental Factors Affecting Collisions: Part 2", gp = gpar(fontsize = 15, fontface = "bold")))

```

Lastly, the **acclass** category classifies the type and severity of traffic collisions with labels such as "Fatal," "Non-Fatal Injury," and "None or Others." The original classifications of "None" and "Property Damage Only" were merged into the "None or Others" category to streamline the data, as both involve accidents without human injury. This consolidation was taken to simplify the analysis by focusing on the human impact of accidents. "Fatal" represents collisions resulting in severe injury, and "Non-Fatal Injury" indicates incidents causing injury but no fatalities. By merging and refining these categories, the focus shifts toward understanding the human consequences of collisions, enabling a more targeted approach to reducing severe injuries and fatalities.

```{r}
#| message: false
#| echo: false
#| label: fig-acclass-distribution
#| fig-cap: Distribution of Accident Classifications (acclass)

# Ensure the 'acclass' column is treated as a factor
cleaned_data <- cleaned_data %>%
  mutate(acclass = factor(acclass, levels = c("Fatal", "Non-Fatal Injury", "None or Others")))

# Summarise the counts for each 'acclass' category
acclass_summary <- cleaned_data %>%
  count(acclass)

# Create the bar plot
ggplot(acclass_summary, aes(x = acclass, y = n, fill = acclass)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = n), vjust = -0.5, nudge_y = 200, size = 3, fontface = "plain", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Accident Classifications",
       x = "Accident Classification",
       y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  coord_cartesian(ylim = c(0, max(acclass_summary$n) * 1.1))  # Adjust y-axis limits for better readability

```

# Discussion

## High-Risk Scenarios for Road Accidents

Upon further review of the heatmap, the top three combinations of environmental and human factors are evident, and I will revise the analysis accordingly.

### High-Risk Scenarios for Road Accidents

The heatmap highlights the intricate relationship between environmental conditions—such as traffic control, visibility, lighting, and road surface—and human factors like speeding, aggressive driving, alcohol use, and disability. This visualization reveals clear trends where specific combinations of these factors lead to the highest rates of road accidents.

The highest-risk combination occurs when **traffic signals are clear, daylight is present, the road is dry, and drivers exhibit aggressive driving behavior**. This combination results in the largest number of accidents. Even though environmental conditions are favorable with clear daylight and dry roads, aggressive driving significantly increases the accident rate. This indicates that aggressive behaviors, such as tailgating or reckless overtaking, are extremely dangerous even in otherwise safe driving conditions. To mitigate these risks, more targeted enforcement of speed limits and penalties for aggressive driving may be necessary in areas where accidents are high, despite good road conditions.

A second high-risk combination involves **no traffic control, clear conditions, daylight, and dry roads, combined with aggressive driving and alcohol use**. This combination results in high accident counts, emphasizing how dangerous aggressive driving becomes when compounded by alcohol consumption, even in seemingly safe environmental conditions. The absence of traffic control in these situations suggests that drivers may feel a false sense of security, which encourages reckless behavior. Enhancing traffic control measures, such as adding stop signs, traffic lights, or roundabouts in high-accident zones, could reduce incidents in these cases.

The third-highest combination includes **no traffic control, disturbed visibility, daylight, and wet road conditions** with **no involvement of impaired behaviors**. This scenario shows how environmental factors like wet roads and poor visibility increase the risk of accidents, even when human behavior is not a contributing factor. The lack of traffic control adds further risk. Addressing this issue through better traffic control measures and improving road surface conditions, such as better drainage systems or warning signs in areas prone to heavy rainfall, can help reduce accidents.

The data reveals that while environmental factors such as wet roads, disturbed visibility, and lack of traffic control are significant contributors to accidents, aggressive driving and alcohol use are key human behaviors that exacerbate risks, even in favorable environmental conditions. Focusing on infrastructure improvements, such as enhancing traffic control in key areas and stricter enforcement against aggressive driving and alcohol-related offenses, could significantly reduce accident rates in the most hazardous scenarios.

```{r fig.width=12, fig.height=15}
#| message: false
#| echo: false
#| label: fig-hh
#| fig-cap: Sample of Result of Collision Data
# Prepare the data by summarizing relevant columns and creating a count of combinations
heatmap_data <- cleaned_data %>%
  group_by(traffctl, visibility, light, rdsfcond, speeding, ag_driv, alcohol, disability) %>%
  summarise(count = n()) %>%
  ungroup()

# Combine human factor columns into one for the x-axis
heatmap_data$human_factors <- interaction(heatmap_data$speeding,
                                          heatmap_data$ag_driv,
                                          heatmap_data$alcohol,
                                          heatmap_data$disability)

# Combine environmental factor columns into one for the y-axis
heatmap_data$environmental_factors <- interaction(heatmap_data$traffctl,
                                                  heatmap_data$visibility,
                                                  heatmap_data$light,
                                                  heatmap_data$rdsfcond)

# Create the heatmap plot with better alignment
ggplot(heatmap_data, aes(x = human_factors, 
                         y = environmental_factors, 
                         fill = count)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "red") +
  labs(x = "Human Factors (speeding, ag_driv, alcohol, disability)", 
       y = "Environmental Factors (traffctl, visibility, light, rdsfcond)", 
       fill = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 15), # Increase text size and rotate
        axis.text.y = element_text(size = 17), # Increase text size
        axis.title = element_text(size = 20), # Increase axis title size
        plot.title = element_text(size = 22),  # Increase title size
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 18),
        panel.grid.major = element_blank(), # Remove gridlines
        panel.grid.minor = element_blank()) +
  ggtitle("Heatmap of Environmental and Human Factors")

```
 

## Can Environmental and Human Factors Serve as Early Warning Indicators?
With the advancement of data-driven technologies, it is possible to predict the severity of motor vehicle accidents based on a combination of human behaviors and environmental conditions. This discussion focuses on how predictive models can be developed to identify the likelihood of severe accidents using factors like speeding, alcohol consumption, poor road conditions, and low visibility.

For example, we could create a system that collects real-time environmental data (e.g., weather, road surface conditions) and cross-references it with information on traffic behaviors (e.g., average speeding rates) to predict whether an area is at high risk for serious accidents. This kind of early warning system could be integrated into navigation apps or smart cars to alert drivers of heightened risks and potentially prevent accidents before they occur.

Predictive analytics can highlight the most dangerous combinations of factors, such as speeding in rainy weather or aggressive driving under poor visibility. In addition, machine learning algorithms can continuously improve these predictions by incorporating accident history data, making the model more robust over time. This offers the potential to shift from reactive to proactive accident prevention, reducing the burden on healthcare systems and increasing road safety.

## Weaknesses and next steps

One notable limitation of this analysis is that the dataset only contains information up until 2023. While this provides a substantial historical perspective on traffic accidents in Toronto, it may not fully capture recent changes in road usage patterns, traffic enforcement, or driver behaviors that have emerged post-2023. For example, the rise of new driving technologies, ride-sharing services, and changes in traffic regulations could have a significant impact on accident rates, but these factors are not reflected in the current dataset. As such, the findings based on this data may not completely align with more recent trends, limiting the relevance of the analysis for current or future policy decisions.

While the dataset used in this analysis ends in 2023, a key area for future exploration involves the broader adoption of autonomous or auto-drive technologies, which are not yet accounted for in the data but could significantly impact traffic accident dynamics. As these technologies become more prevalent, understanding their effect on traffic safety, accident rates, and accident severity will be critical. The absence of this data limits our ability to predict how autonomous driving might influence future accident patterns. However, from the figure "fig-trend-over-time," we observe that collisions involving aggressive driving (ag_driv) have decreased over time, which may be indicative of increased use of autonomous or driver-assist technologies that mitigate reckless behavior. Future research should incorporate data on autonomous vehicles and their interaction with human-driven cars to better assess how these advancements influence safety and accident risks. This could lead to the development of predictive models that combine human and automated driving behaviors, aiding policymakers and urban planners in shaping infrastructure and safety regulations for a future where both types of vehicles coexist.

\newpage


# References


