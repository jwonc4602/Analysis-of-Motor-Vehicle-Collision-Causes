---
title: "Analysis of Motor Vehicle Collision Causes in Toronto from 2006 to 2023"
subtitle: "Exploring the Interplay of Human Behavior and Environmental Factors in Predicting Accident Severity and High-Risk Scenarios"
author: 
  - Jiwon Choi
thanks: "Code and data are available at: https://github.com/jwonc4602/Analysis-of-Motor-Vehicle-Collision-Causes."
date: today
date-format: long
abstract: "This study analyzes motor vehicle collisions in Toronto from 2006 to 2023, focusing on the interaction between human behaviors—such as speeding, aggressive driving, and alcohol use—and environmental conditions like visibility and road surfaces. The findings show that while environmental factors increase risks, aggressive driving and alcohol use are the strongest predictors of severe accidents. These results highlight the need for targeted interventions in both driver behavior and infrastructure to improve urban traffic safety."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace set-up ####

## Load packages
library(tidyverse)
library(knitr)
library(here)
library(dplyr)
library(ggplot2)
library(readr)
library(gridExtra)
library(grid)

#read in cleaned data #
#total_cleaned_data
cleaned_data <- read.csv(here::here("data/analysis_data/total_cleaned_data.csv"))
show_col_types = FALSE

# human factors data
human_factors_data <- read.csv(here::here("data/analysis_data/human_factors_data.csv"))
show_col_types = FALSE

# environmental factors data
environmental_factors_data <- read.csv(here::here("data/analysis_data/environmental_factors_data.csv"))
show_col_types = FALSE

```


# Introduction

Motor vehicle collisions are a leading cause of injury and fatality in urban areas, driving ongoing efforts to improve road safety. In a rapidly expanding city like Toronto, understanding the causes of traffic accidents is critical for shaping effective policies. This paper examines traffic collisions in Toronto over a 17-year period, focusing on how human behavior and environmental conditions together influence the frequency and severity of accidents.

While much research has been done on factors such as speeding or poor road conditions, there is still a lack of understanding regarding the interaction between human behaviors and environmental conditions in creating high-risk situations. Most studies focus on these factors separately, missing how they combine to increase accident risks. This research addresses that gap by analyzing both human and environmental factors simultaneously, offering a more complete view of what drives traffic accidents in an urban setting.

Using data from Toronto Police Services, this study analyzes the role of human factors like speeding, aggressive driving, alcohol use, and disability alongside environmental factors such as visibility, lighting, traffic control, and road conditions. The results show that aggressive driving and alcohol use, even under good road conditions, are major contributors to accidents. High-risk scenarios, like aggressive driving on dry roads with clear visibility, emerge as leading causes of collisions. These findings suggest targeted actions, such as stricter enforcement against reckless driving and improved traffic controls in key areas, could help reduce accident rates.

The rest of the paper is organized as follows. Section 2 outlines the data and methodology. Section 3 presents the analysis of factors contributing to traffic collisions. Section 4 discusses the results and potential interventions. Section 5 addresses the study’s limitations and proposes future research directions, particularly the need to consider the growing role of autonomous driving technologies in accident analysis.

# Data {#sec-data}

## Data Source

This research is based on a dataset published by Toronto Police Services, which is accessible through the City of Toronto’s OpenDataToronto Library [@rOpenDataToronto]. The specific dataset includes all traffic collisions events in Toronto where a person was either Killed or Seriously Injured (KSI) since 2006.

## Data Collection

The methodology for gathering data is structured to ensure a detailed and current perspective of shelter and overnight service. The data was compiled and examined using the R statistical programming software [@r], supplemented by various tools such as `tidyverse` [@rTidyverse], `ggplot2` [@rGgplot2], `dplyr` [@rDplyr], `readr` [@rReadr], `tibble` [@rTibble], `janitor` [@rJanitor], `knitr` [@rknitr], and `here` [@rHere].

This traffic accident dataset contains 18,957 entries from a citywide survey, detailing various factors involved in incidents. It includes 50 variables covering geographic data, such as accident locations, and behavioral data, like driver conditions and alcohol involvement. The dataset spans several years and captures environmental conditions, road types, and the actions of drivers and pedestrians during accidents. It aims to provide a comprehensive view for research and policy efforts related to urban traffic safety and accident prevention.

The cleaned data is split into two sets. The first focuses on human factors, particularly driver behaviors and conditions that may have contributed to accidents. Four key categories—'speeding,' 'ag_driv,' 'alcohol,' and 'disability'—were selected due to their known impact on traffic accidents. Each is recorded as either "None" or "Yes," indicating whether that factor was present in the incident. These categories focus on preventable human actions or conditions that are strongly linked to traffic risks.

1. **Speeding**: Tracks whether speeding was a factor in the collision. Speeding reduces reaction time and increases crash severity, making it a leading cause of accidents.

2. **Aggressive Driving (ag_driv)**: Refers to reckless or distracted behaviors, such as texting while driving. These actions impair judgment and reaction time, significantly increasing accident risk.

3. **Alcohol**: Captures whether alcohol was involved in the collision. Alcohol impairs motor skills and decision-making, contributing to many severe and fatal accidents.

4. **Disability**: Notes if a medical or physical disability affected the driver's ability to control the vehicle. Disabilities can impair a driver's capacity to respond to road conditions, making this a key safety factor.

These factors are critical to understanding the human behaviors that increase traffic accident risks and can inform strategies to reduce both the frequency and severity of collisions.

```{r}
#| message: false
#| echo: false
#| label: fig-frequency-factors-tall
#| fig-cap: Frequency of human factors with thinner numbers and taller graph

# Convert relevant columns to factors and reorder them for better readability
human_factors_data <- human_factors_data %>%
  mutate(speeding = factor(speeding, levels = c("None", "Yes")),
         ag_driv = factor(ag_driv, levels = c("None", "Yes")),
         alcohol = factor(alcohol, levels = c("None", "Yes")),
         disability = factor(disability, levels = c("None", "Yes")))

# Frequency summary for each factor
factor_summary <- human_factors_data %>%
  summarise(
    speeding = sum(speeding == "Yes"),
    ag_driv = sum(ag_driv == "Yes"),
    alcohol = sum(alcohol == "Yes"),
    disability = sum(disability == "Yes")
  ) %>%
  tidyr::gather(key = "factor", value = "count")

# Split the category name for 'ag_driv'
factor_summary <- factor_summary %>%
  mutate(factor = str_replace_all(factor, "ag_driv", "aggressive\nand disturbed driving"))

# Reorder factors based on count for better visualization
factor_summary <- factor_summary %>%
  mutate(factor = forcats::fct_reorder(factor, count, .desc = TRUE))

# Bar plot with thinner numbers and taller graph
ggplot(factor_summary, aes(x = factor, y = count, fill = factor)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = count), vjust = -0.5, nudge_y = 200, size = 3, fontface = "plain", color = "black") +  # Thinner numbers
  theme_minimal() +
  labs(title = "Frequency of Human Factors in Traffic Collisions",
       x = "Human Factors",
       y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Adjust x-axis labels
  coord_cartesian(ylim = c(0, 11000))  # Adjust the y-axis limit to make the graph taller

```

```{r}
#| message: false
#| echo: false
#| label: fig-trend-over-time
#| fig-cap: Trends of human factors in traffic collisions over time

# Convert the date column to date format
human_factors_data <- human_factors_data %>%
  mutate(date = as.Date(date, format = "%Y-%m-%d"))

# Summarise the presence of each factor by year
trend_data <- human_factors_data %>%
  mutate(year = lubridate::year(date)) %>%
  group_by(year) %>%
  summarise(
    speeding = sum(speeding == "Yes"),
    ag_driv = sum(ag_driv == "Yes"),
    alcohol = sum(alcohol == "Yes"),
    disability = sum(disability == "Yes")
  ) %>%
  tidyr::gather(key = "factor", value = "count", -year)

# Line plot to show trends over time
ggplot(trend_data, aes(x = year, y = count, color = factor)) +
  geom_line(linewidth = 0.8) +
  theme_minimal() +
  labs(title = "Trends in Human Factors Over Time",
       x = "Year",
       y = "Count of Collisions",
       color = "Human Factor")
```
The second dataset focuses on environmental factors that influence traffic collisions, including conditions such as traffic control, visibility, lighting, and road surface. These elements shape driver behavior and impact accident risk. To simplify analysis and improve consistency, categories were consolidated, providing clearer insights into how these factors affect accidents and where safety improvements are needed. (see @tbl-cleaned-environmental-factors-data)

1. **Traffic Control Type**: This was simplified into "No Control," "Traffic Signal," and "Others." The "Others" group combines less common traffic controls like stop signs and pedestrian crossovers. This distinction highlights the impact of varying levels of traffic regulation on driver behavior, focusing on scenarios where traffic control presence may influence accident risks.

2. **Visibility**: Conditions were grouped into "Clear" and "Disturbed," with "Disturbed" covering adverse weather such as fog, rain, and snow. This division highlights the contrast between ideal and hazardous visibility, which directly affects a driver's ability to navigate safely. Poor visibility is a known factor in accidents, making this an essential category for identifying environmental hazards.

3. **Light**: Lighting conditions were combined into "Dark," "Daylight," and "Dim Light." These reflect the most relevant lighting environments, with "Dark" including both natural and artificial lighting, and "Dim Light" covering intermediate conditions like dawn and dusk. Lighting plays a crucial role in visibility and reaction times, and this grouping helps assess its role in accidents.

4. **Road Surface Condition**: This was grouped into "Dry," "Wet," and "Others." The "Others" category includes ice, snow, and slush, conditions that greatly reduce vehicle traction. Focusing on major surface conditions helps clarify how road conditions influence accident risk, especially in wet or slippery environments.

These modifications prioritize the key environmental factors affecting traffic safety. By simplifying and grouping variables, the dataset becomes easier to interpret, allowing a clearer understanding of how conditions like traffic control, visibility, lighting, and road surfaces contribute to collisions. This approach supports targeted interventions aimed at improving road safety and reducing accident rates.

```{r}
#| message: false
#| echo: false
#| label: tbl-cleaned-environmental-factors-data
#| tbl-cap: Sample of Environmental Factors of Collision Data

head (environmental_factors_data, 5) |>
  kable(
    col.names = c("date", "traffctl", "visibility", "light", "rdsfcond"),
  booktabs = TRUE
  )
```

```{r}
#| message: false
#| echo: false
#| label: fig-four-graphs-layout
#| fig-cap: Combined layout with four simplified collision graphs

# Common theme
common_theme <- theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),  # Slightly larger font for clarity
    axis.title.x = element_text(size = 12),
    axis.title.y = element_text(size = 12),
    plot.title = element_text(size = 10),
    plot.margin = margin(t = 15, r = 15, b = 15, l = 15)  # Margins for more space
  )

# First plot: Traffic Control Type and Visibility Conditions

# Plot 1: Traffic Control Type
plot1 <- ggplot(environmental_factors_data, aes(x = traffctl)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +
  labs(title = "Collisions by Traffic Control Type",
       x = "Traffic Control Type",
       y = "Number of Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$traffctl)) * 1.2))

# Plot 2: Visibility Conditions
plot2 <- ggplot(environmental_factors_data, aes(x = visibility)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +
  labs(title = "Collisions by Visibility Conditions",
       x = "Visibility",
       y = "Number of Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$visibility)) * 1.2))

# Arrange these two plots side by side
first_plot_pair <- grid.arrange(plot1, plot2, ncol = 2, 
                                top = textGrob("Environmental Factors Affecting Collisions", gp = gpar(fontsize = 15, fontface = "bold")))

```

```{r}
#| message: false
#| echo: false
#| label: tbl-cleaned-environmental-factors-data-2
#| tbl-cap: Sample of Environmental Factors of Collision Data 2

# Common theme
common_theme <- theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
    axis.title.x = element_text(size = 10),
    axis.title.y = element_text(size = 10),
    plot.title = element_text(size = 10),  # No bold here
    plot.margin = margin(t = 15, r = 15, b = 15, l = 15)  # Margins for more space
  )

# Second plot: Lighting Conditions and Road Surface Condition

# Plot 3: Lighting Conditions
plot3 <- ggplot(environmental_factors_data, aes(x = light)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +  # Apply the common theme
  labs(title = "Collisions by Lighting Conditions",
       x = "Lighting Conditions",
       y = "Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$light)) * 1.2))

# Plot 4: Road Surface Conditions
plot4 <- ggplot(environmental_factors_data, aes(x = rdsfcond)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5, size = 3) +
  common_theme +  # Apply the common theme
  labs(title = "Collisions by Road Surface Condition",
       x = "Road Surface Condition",
       y = "Collisions") +
  coord_cartesian(ylim = c(0, max(table(environmental_factors_data$rdsfcond)) * 1.2))

# Arrange these two plots side by side
second_plot_pair <- grid.arrange(plot3, plot4, ncol = 2, 
                                 top = textGrob("Environmental Factors Affecting Collisions: Part 2", gp = gpar(fontsize = 15, fontface = "bold")))

```

The **acclass** category classifies the severity of traffic collisions into "Fatal," "Non-Fatal Injury," and "None or Others." The original categories "None" and "Property Damage Only" were combined into "None or Others" since both involve accidents without human injury. This consolidation simplifies the analysis, focusing on accidents with a direct human impact. "Fatal" refers to collisions causing severe injury or death, while "Non-Fatal Injury" includes incidents with injuries but no fatalities. By merging and refining these categories, the data emphasizes the human consequences of accidents, helping target efforts to reduce severe injuries and fatalities.

```{r}
#| message: false
#| echo: false
#| label: fig-acclass-distribution
#| fig-cap: Distribution of Accident Classifications (acclass)

# Ensure the 'acclass' column is treated as a factor
cleaned_data <- cleaned_data %>%
  mutate(acclass = factor(acclass, levels = c("Fatal", "Non-Fatal Injury", "None or Others")))

# Summarise the counts for each 'acclass' category
acclass_summary <- cleaned_data %>%
  count(acclass)

# Create the bar plot
ggplot(acclass_summary, aes(x = acclass, y = n, fill = acclass)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = n), vjust = -0.5, nudge_y = 200, size = 3, fontface = "plain", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Accident Classifications",
       x = "Accident Classification",
       y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  coord_cartesian(ylim = c(0, max(acclass_summary$n) * 1.1))  # Adjust y-axis limits for better readability

```

# Discussion

## High-Risk Scenarios for Road Accidents

The heatmap shows the relationship between environmental factors—traffic control, visibility, lighting, and road surface—and human behaviors like speeding, aggressive driving, alcohol use, and disability. It highlights clear patterns where certain combinations lead to higher accident rates.

The most dangerous combination occurs when **traffic signals are present, daylight is clear, the road is dry, and aggressive driving is involved**. Even in ideal environmental conditions, aggressive driving leads to the highest number of accidents. This suggests that behaviors like tailgating and reckless overtaking pose significant risks, even on dry roads with good visibility. To reduce accidents in such areas, stricter enforcement of speed limits and penalties for aggressive driving may be necessary.

Another high-risk combination is **no traffic control, clear conditions, daylight, dry roads, and aggressive driving coupled with alcohol use**. The lack of traffic control in this scenario appears to give drivers a false sense of safety, leading to reckless behavior. Installing traffic controls, like stop signs or roundabouts, in areas with high accident rates could help reduce these incidents.

A third combination showing increased risk involves **no traffic control, poor visibility, daylight, and wet roads**, but **no involvement of risky behaviors**. This highlights how wet roads and low visibility increase accident risks, even without human error. Improving road infrastructure, such as adding drainage systems or warning signs in areas prone to heavy rainfall, and introducing traffic controls could help prevent accidents under these conditions.

The data shows that while environmental factors like wet roads and poor visibility are important, aggressive driving and alcohol use are key behaviors that amplify risk, even in favorable conditions. Focusing on improving infrastructure and stricter enforcement against aggressive driving and alcohol-related offenses could significantly lower accident rates in these high-risk scenarios.

```{r fig.width=12, fig.height=15}
#| message: false
#| echo: false
#| label: fig-hh
#| fig-cap: Sample of Result of Collision Data
# Prepare the data by summarizing relevant columns and creating a count of combinations
heatmap_data <- cleaned_data %>%
  group_by(traffctl, visibility, light, rdsfcond, speeding, ag_driv, alcohol, disability) %>%
  summarise(count = n()) %>%
  ungroup()

# Combine human factor columns into one for the x-axis
heatmap_data$human_factors <- interaction(heatmap_data$speeding,
                                          heatmap_data$ag_driv,
                                          heatmap_data$alcohol,
                                          heatmap_data$disability)

# Combine environmental factor columns into one for the y-axis
heatmap_data$environmental_factors <- interaction(heatmap_data$traffctl,
                                                  heatmap_data$visibility,
                                                  heatmap_data$light,
                                                  heatmap_data$rdsfcond)

# Create the heatmap plot with better alignment
ggplot(heatmap_data, aes(x = human_factors, 
                         y = environmental_factors, 
                         fill = count)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "lightblue", high = "red") +
  labs(x = "Human Factors (speeding, ag_driv, alcohol, disability)", 
       y = "Environmental Factors (traffctl, visibility, light, rdsfcond)", 
       fill = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 15), # Increase text size and rotate
        axis.text.y = element_text(size = 17), # Increase text size
        axis.title = element_text(size = 20), # Increase axis title size
        plot.title = element_text(size = 22),  # Increase title size
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 18),
        panel.grid.major = element_blank(), # Remove gridlines
        panel.grid.minor = element_blank()) +
  ggtitle("Heatmap of Environmental and Human Factors")

```
 

## Can Environmental and Human Factors Serve as Early Warning Indicators?

With advances in data-driven technologies, it's now possible to predict the severity of motor vehicle accidents by analyzing a combination of human behaviors and environmental conditions. This section focuses on how predictive models can be developed to assess the likelihood of severe accidents using factors such as speeding, alcohol use, poor road conditions, and low visibility.

For instance, a system could gather real-time environmental data, such as weather and road surface conditions, and combine it with information on traffic behaviors, like speeding patterns, to determine if an area is at high risk for serious accidents. This type of early warning system could be integrated into navigation apps or smart cars to alert drivers to potential dangers and help prevent accidents before they occur.

Predictive analytics can identify the most dangerous combinations of factors, such as speeding during rainy weather or aggressive driving in poor visibility. Machine learning algorithms could continuously improve these models by incorporating historical accident data, making the predictions more accurate over time. This approach shifts accident prevention from a reactive to a proactive strategy, which could reduce the strain on healthcare systems and improve overall road safety.

## Weaknesses and next steps

One limitation of this analysis is that the dataset only includes data up to 2023. While this offers a strong historical perspective on traffic accidents in Toronto, it does not account for more recent shifts in road usage, traffic enforcement, or driver behavior that may have emerged after 2023. For example, new driving technologies, ride-sharing services, and updated traffic regulations could significantly influence accident rates, but these factors are not reflected in the current data. As a result, the findings may not fully align with recent trends, limiting their relevance for current and future policy decisions.

A key area for future research involves the growing use of autonomous or driver-assist technologies, which are not yet covered by the dataset but could have a major impact on traffic accident patterns. As these technologies become more common, understanding their effect on traffic safety and accident severity will be essential. The lack of data on autonomous vehicles limits our ability to predict how these innovations might change accident trends. However, from the figure @fig-trend-over-time, we see that accidents involving aggressive driving have decreased, possibly due to the rise of driver-assist features that reduce reckless behavior. Future studies should incorporate data on autonomous vehicles and their interactions with human-driven cars to better understand how these advancements affect safety. This could help develop predictive models that account for both human and automated driving behaviors, providing valuable insights for policymakers and urban planners as they adapt infrastructure and safety regulations for a future where both types of vehicles share the road.

\newpage


# References


